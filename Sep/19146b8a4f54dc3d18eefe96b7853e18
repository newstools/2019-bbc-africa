An Iranian sailor has been released by Somali pirates after spending more than four years in captivity. Mohammad Sharif Panahandeh was "seriously ill" and has been freed on humanitarian grounds, the Hostage Support Partnership (HSP), which helped negotiate his release, said. Over the past decade, thousands of crew have been taken hostage off the coast of Somalia and released for a ransom. Mr Sharif's freedom means pirates are holding just three people captive. Pirate attacks in the region peaked in 2011 but have declined to negligible levels in recent years, the European Naval Force, which operates in the area, says. The three remaining hostages are all Iranian nationals and were taken with Mr Sharif from a fishing boat in March 2015, John Steed from HSP told the BBC. "[Mr Sharif is] severely malnourished. He lost a huge amount of weight [and has] severe stomach problems and internal bleeding," Mr Steed is quoted by the AFP news agency as saying. The sailor was taken to the Ethiopian capital, Addis Ababa, for initial treatment and is set to be flown home. Iran has thanked HSP, the UN, the authorities in Somalia's semi-autonomous Puntland region and Ethiopia for helping, Reuters reports, quoting Iran's official news agency. Mr Sharif was released because of his health, but the pirates may still want a ransom for the remaining three, Mr Steed told AFP. The decline in piracy off the Somali coast has been attributed to the use of armed guards on vessels sailing in the area, as well as the work of several navies, including from the European Union and Nato.